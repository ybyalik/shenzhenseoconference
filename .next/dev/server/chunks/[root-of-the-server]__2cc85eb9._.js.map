{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/email.ts"],"sourcesContent":["import nodemailer from 'nodemailer';\n\nconst transporter = nodemailer.createTransport({\n  host: 'smtp-relay.brevo.com',\n  port: 587,\n  secure: false,\n  auth: {\n    user: process.env.BREVO_SMTP_EMAIL,\n    pass: process.env.BREVO_API_KEY,\n  },\n});\n\nexport async function sendEmail({\n  to,\n  subject,\n  html,\n  text,\n}: {\n  to: string;\n  subject: string;\n  html: string;\n  text?: string;\n}) {\n  try {\n    const info = await transporter.sendMail({\n      from: `\"Shenzhen SEO Conference\" <${process.env.BREVO_SMTP_EMAIL}>`,\n      to,\n      subject,\n      html,\n      text: text || html.replace(/<[^>]*>/g, ''),\n    });\n\n    console.log('Email sent:', info.messageId);\n    return { success: true, messageId: info.messageId };\n  } catch (error) {\n    console.error('Error sending email:', error);\n    throw error;\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,4JAAU,CAAC,eAAe,CAAC;IAC7C,MAAM;IACN,MAAM;IACN,QAAQ;IACR,MAAM;QACJ,MAAM,QAAQ,GAAG,CAAC,gBAAgB;QAClC,MAAM,QAAQ,GAAG,CAAC,aAAa;IACjC;AACF;AAEO,eAAe,UAAU,EAC9B,EAAE,EACF,OAAO,EACP,IAAI,EACJ,IAAI,EAML;IACC,IAAI;QACF,MAAM,OAAO,MAAM,YAAY,QAAQ,CAAC;YACtC,MAAM,CAAC,2BAA2B,EAAE,QAAQ,GAAG,CAAC,gBAAgB,CAAC,CAAC,CAAC;YACnE;YACA;YACA;YACA,MAAM,QAAQ,KAAK,OAAO,CAAC,YAAY;QACzC;QAEA,QAAQ,GAAG,CAAC,eAAe,KAAK,SAAS;QACzC,OAAO;YAAE,SAAS;YAAM,WAAW,KAAK,SAAS;QAAC;IACpD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,MAAM;IACR;AACF"}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/contact/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { z } from 'zod';\nimport { sendEmail } from '@/lib/email';\n\nconst contactFormSchema = z.object({\n  firstName: z.string().min(1, \"First name is required\"),\n  lastName: z.string().min(1, \"Last name is required\"),\n  email: z.string().email(\"Please enter a valid email address\"),\n  requestInvitationLetter: z.boolean(),\n  nationality: z.string().optional(),\n  passportNo: z.string().optional(),\n  passportIssuingOffice: z.string().optional(),\n  dateOfIssue: z.string().optional(),\n  passportExpiration: z.string().optional(),\n  jobTitle: z.string().optional(),\n  durationOfStay: z.string().optional(),\n  additionalMessage: z.string().optional(),\n}).refine((data) => {\n  if (data.requestInvitationLetter) {\n    return (\n      data.nationality &&\n      data.passportNo &&\n      data.passportIssuingOffice &&\n      data.dateOfIssue &&\n      data.passportExpiration &&\n      data.jobTitle &&\n      data.durationOfStay\n    );\n  }\n  return true;\n}, {\n  message: \"All fields are required when requesting a business invitation letter\",\n  path: [\"requestInvitationLetter\"],\n});\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const validatedData = contactFormSchema.parse(body);\n\n    console.log('Contact form received:', validatedData);\n\n    const emailSubject = validatedData.requestInvitationLetter\n      ? 'New Business Invitation Letter Request'\n      : 'New Contact Form Submission';\n\n    let emailHtml = `\n      <h2>${emailSubject}</h2>\n      <p><strong>Name:</strong> ${validatedData.firstName} ${validatedData.lastName}</p>\n      <p><strong>Email:</strong> ${validatedData.email}</p>\n    `;\n\n    if (validatedData.requestInvitationLetter) {\n      emailHtml += `\n        <h3>Passport Information</h3>\n        <p><strong>Nationality:</strong> ${validatedData.nationality}</p>\n        <p><strong>Passport No.:</strong> ${validatedData.passportNo}</p>\n        <p><strong>Issuing Office:</strong> ${validatedData.passportIssuingOffice}</p>\n        <p><strong>Date of Issue:</strong> ${validatedData.dateOfIssue}</p>\n        <p><strong>Expiration Date:</strong> ${validatedData.passportExpiration}</p>\n        <p><strong>Job Title:</strong> ${validatedData.jobTitle}</p>\n        <p><strong>Duration of Stay:</strong> ${validatedData.durationOfStay}</p>\n      `;\n    }\n\n    if (validatedData.additionalMessage) {\n      emailHtml += `\n        <h3>Additional Message</h3>\n        <p>${validatedData.additionalMessage}</p>\n      `;\n    }\n\n    await sendEmail({\n      to: 'jp@shenzhenseoconference.com',\n      subject: emailSubject,\n      html: emailHtml,\n    });\n\n    return NextResponse.json({\n      success: true,\n      message: 'Contact form received successfully',\n      data: validatedData,\n    }, { status: 201 });\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return NextResponse.json({\n        success: false,\n        message: 'Validation error',\n        errors: error.errors,\n      }, { status: 400 });\n    }\n\n    console.error('Contact form error:', error);\n    return NextResponse.json({\n      success: false,\n      message: 'Internal server error',\n    }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,oBAAoB,2IAAC,CAAC,MAAM,CAAC;IACjC,WAAW,2IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC7B,UAAU,2IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,OAAO,2IAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,yBAAyB,2IAAC,CAAC,OAAO;IAClC,aAAa,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAChC,YAAY,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAC/B,uBAAuB,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAC1C,aAAa,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAChC,oBAAoB,2IAAC,CAAC,MAAM,GAAG,QAAQ;IACvC,UAAU,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,gBAAgB,2IAAC,CAAC,MAAM,GAAG,QAAQ;IACnC,mBAAmB,2IAAC,CAAC,MAAM,GAAG,QAAQ;AACxC,GAAG,MAAM,CAAC,CAAC;IACT,IAAI,KAAK,uBAAuB,EAAE;QAChC,OACE,KAAK,WAAW,IAChB,KAAK,UAAU,IACf,KAAK,qBAAqB,IAC1B,KAAK,WAAW,IAChB,KAAK,kBAAkB,IACvB,KAAK,QAAQ,IACb,KAAK,cAAc;IAEvB;IACA,OAAO;AACT,GAAG;IACD,SAAS;IACT,MAAM;QAAC;KAA0B;AACnC;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,gBAAgB,kBAAkB,KAAK,CAAC;QAE9C,QAAQ,GAAG,CAAC,0BAA0B;QAEtC,MAAM,eAAe,cAAc,uBAAuB,GACtD,2CACA;QAEJ,IAAI,YAAY,CAAC;UACX,EAAE,aAAa;gCACO,EAAE,cAAc,SAAS,CAAC,CAAC,EAAE,cAAc,QAAQ,CAAC;iCACnD,EAAE,cAAc,KAAK,CAAC;IACnD,CAAC;QAED,IAAI,cAAc,uBAAuB,EAAE;YACzC,aAAa,CAAC;;yCAEqB,EAAE,cAAc,WAAW,CAAC;0CAC3B,EAAE,cAAc,UAAU,CAAC;4CACzB,EAAE,cAAc,qBAAqB,CAAC;2CACvC,EAAE,cAAc,WAAW,CAAC;6CAC1B,EAAE,cAAc,kBAAkB,CAAC;uCACzC,EAAE,cAAc,QAAQ,CAAC;8CAClB,EAAE,cAAc,cAAc,CAAC;MACvE,CAAC;QACH;QAEA,IAAI,cAAc,iBAAiB,EAAE;YACnC,aAAa,CAAC;;WAET,EAAE,cAAc,iBAAiB,CAAC;MACvC,CAAC;QACH;QAEA,MAAM,IAAA,2HAAS,EAAC;YACd,IAAI;YACJ,SAAS;YACT,MAAM;QACR;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT,MAAM;QACR,GAAG;YAAE,QAAQ;QAAI;IACnB,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,2IAAC,CAAC,QAAQ,EAAE;YAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,SAAS;gBACT,QAAQ,MAAM,MAAM;YACtB,GAAG;gBAAE,QAAQ;YAAI;QACnB;QAEA,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;QACX,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF"}}]
}